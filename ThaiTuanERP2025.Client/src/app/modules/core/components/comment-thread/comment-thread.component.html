<div class="comment-item" style="margin-left: 15px;">

      <div class="comment-wrapper">
            <div class="comment-content display-flex gap-5px align-items-center">
                  <img class="avatar-user" [src]="comment.user | avatarUrlPipe">

                  <div class="comment-content display-flex flex-column gap-5px">
                        <div class="comment-header display-flex gap-10px">
                              <strong>{{ comment.user.fullName }}</strong>
                              <span class="comment-time">{{ comment.createdAt | date:'short' }}</span>
                        </div>

                        <div class="comment-text">{{ comment.content }}</div>
                  </div>
             </div>

            <div class="comment-actions display-flex justify-content-between">

                  <!-- Toggle replies -->
                  <ng-container *ngIf="comment.replies?.length; else placeholder">
                        <div class="reply-toggle" (click)="toggleReplies()">
                              <button type="button" class="comment-reply-button color-aaa" *ngIf="!expanded">
                                    Xem {{ comment.replies.length }} phản hồi
                              </button>

                              <button type="button" class="comment-reply-button color-aaa" *ngIf="expanded">
                                    Ẩn phản hồi
                              </button>
                        </div>
                  </ng-container>

                  <ng-template #placeholder>
                        <div style="visibility: hidden;"></div>
                  </ng-template>

                  <button class="comment-reply-button color-aaa" (click)="onReply()">Phản hồi</button>
            </div>
      </div>

      <!-- Reply textbox -->
      <div *ngIf="replyingToCommentId === comment.id" class="reply-box display-flex flex-column gap-10px">
            <input type="text" class="comment-input" placeholder="Viết phản hồi..." [formControl]="replyControl">

            <div class="reply-actions display-flex gap-5px justify-content-end">
                  <button class="button cancel-button padding-5px border-radius-3px" (click)="onCancel()">Hủy</button>
                  <kit-spinner-button type="button" cssClass="save-button padding-5px border-radius-3px" text="Phản hồi" 
                  (click)="onSubmitReply()" [disabled]="!canSubmitReply"></kit-spinner-button>
            </div> 
      </div>

      <!-- Render child replies -->
      <div class="replies" *ngIf="expanded && comment.replies?.length">
            <comment-thread
                  *ngFor="let child of comment.replies; trackBy: trackById"
                  [comment]="child"
                  [depth]="depth + 1"
                  [replyingToCommentId]="replyingToCommentId"
                  (replyRequest)="replyRequest.emit($event)"
                  (submitReply)="submitReply.emit($event)"
                  (cancelReply)="cancelReply.emit()">
            </comment-thread>
      </div>

</div>
