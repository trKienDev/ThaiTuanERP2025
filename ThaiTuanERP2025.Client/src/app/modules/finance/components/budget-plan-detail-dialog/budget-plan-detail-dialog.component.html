<div class="dialog" style="min-width: 600px;">
      <div class="dialog-container">
            <div class="dialog-heading">
                  <div class="display-flex align-items-center">
                        <ng-container *ngIf="isExpired(budgetPlan.dueAt) && budgetPlan.status != 2">
                              <div class="margin-left-auto">
                                    <span class="badge danger-badge">Quá hạn duyệt</span>
                              </div>
                        </ng-container>
                        <ng-container *ngIf="!isExpired(budgetPlan.dueAt) && budgetPlan.status != 2">
                              <div class="payment-due-time margin-left-auto">
                                    <kit-flip-countdown [timeLeft]="getSecondsRemaining(budgetPlan.dueAt)"></kit-flip-countdown>
                              </div>
                        </ng-container>
                  </div>
                  <div class="dialog-title">
                        <h1>Chi tiết ngân sách</h1>
                  </div>
                  <div class="dialog-close">
                        <button type="button" class="close-button" (click)="close()">
                              <span class="text material-icons-outlined">close</span>
                        </button>
                  </div>
            </div>
            <div class="dialog-body">
                  <table class="table">
                        <thead>
                              <tr>
                                    <th>#</th>
                                    <th>Mã ngân sách</th>
                                    <th>Kinh phí</th>
                                    <ng-container *ngIf="showReviewButton">
                                          <th>Chỉnh sửa</th>
                                    </ng-container>
                              </tr>
                        </thead>
                        <tbody>
                              <tr *ngFor="let detail of budgetPlan.details; let i = index;">
                                    <td>{{ i + 1 }}</td>
                                    <td>{{ detail.budgetCode.name }}</td>
                                    <td>
                                          <!-- Nếu đang edit dòng này -->
                                          <ng-container *ngIf="editingIndex === i; else viewMode">
                                                <input type="text"[(ngModel)]="editAmountValue" inputmode="decimal" appMoney [appMoneyDecimals]="0"/>
                                          </ng-container>
                                          <ng-template #viewMode>
                                                {{ detail.amount | number:'1.0-0' }}
                                          </ng-template>
                                    </td>
                                    <ng-container *ngIf="showReviewButton">
                                          <td>
                                                <!-- Nếu đang edit -->
                                                <ng-container *ngIf="editingIndex === i; else editButton">
                                                      <div class="display-flex gap-5px">
                                                            <button class="button pintura-button" (click)="saveEdit(detail)" [disabled]="submitting">Lưu</button>
                                                            <button class="button cancel-button" (click)="cancelEdit()" [disabled]="submitting">Hủy</button>
                                                      </div>
                                                </ng-container>

                                                <!-- Nút Edit -->
                                                <ng-template #editButton>
                                                      <button class="button icon-button" (click)="startEdit(i, detail)" style="max-height: 36px;">
                                                            <span class="text material-icons-round" style="font-size: 13px;">create</span>
                                                      </button>
                                                </ng-template>
                                          </td>
                                    </ng-container>
                              </tr>
                        </tbody>
                  </table>
            </div>
            <div class="dialog-footer display-flex gap-10px">
                  <ng-container *ngIf="showReviewButton">
                        <div class="width-50pt">
                              <kit-spinner-button type="button" cssClass="width-100pt save-button" [loading]="submitting" text="Gửi phê duyệt" (click)="markReview()"></kit-spinner-button>
                        </div>
                        <button class="width-50pt button cancel-button" (click)="close(false)">Hủy</button>
                  </ng-container>
                  <ng-container *ngIf="showApproveButton">
                        <kit-spinner-button class="flex-1" type="button" cssClass="submit-button" [loading]="submitting" text="Phê duyệt" (click)="approve()"></kit-spinner-button>
                        <kit-spinner-button class="flex-1" type="button" cssClass="danger-button display-flex justify-content-center" [loading]="submitting" text="Từ chối"></kit-spinner-button>
                  </ng-container>
            </div>
      </div>
</div>