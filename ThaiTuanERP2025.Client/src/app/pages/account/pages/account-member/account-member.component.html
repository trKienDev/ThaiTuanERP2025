<div class="page-heading">
      <div class="page-title">
            <h3 class="icon">üë®üèª‚Äçüíª</h3>
            <h3 class="title" >Qu·∫£n l√Ω th√†nh vi√™n</h3>
      </div>
      <div>
            <button type="button" class="button default-button" (click)="openUserRequestDialog()">Th√™m ng∆∞·ªùi d√πng m·ªõi</button>
      </div>
</div>

<div class="page-body">
      <table class="table mar-top-20">
            <thead>
                  <tr>
                        <th>#</th>
                        <th>H·ªç v√† t√™n</th>
                        <th>M√£ nh√¢n vi√™n</th>
                        <th>Ph√≤ng ban</th>
                        <th>Qu·∫£n l√Ω</th>
                        <th></th>
                  </tr>
            </thead>
            <tbody>
                  <tr *ngFor="let user of (users$ | async) ?? []; trackBy: trackById; let i = index;">
                        <td>{{ i + 1 }}</td>
                        <td>{{ user.fullName }}</td>
                        <td>{{ user.employeeCode }}</td>
                        <td>{{ user.department?.name }}</td>
                        <td>{{ user.manager?.fullName }}</td>
                        <td>
                              <div class="dropdown-menu">
                                    <button type="button" class="non-decorated-button"  aria-label="th√™m b∆∞·ªõc duy·ªát" 
                                          cdkOverlayOrigin #userMenuOrigin="cdkOverlayOrigin" 
                                          [attr.aria-expanded]="userMenuOpenIndex === i"
                                          (click)="toggleUserMenu(i, $event)">
                                          <span class="material-icons-outlined" style="font-size: initial;">more_horiz</span>
                                    </button>
                                    <ng-template cdkConnectedOverlay 
                                          [cdkConnectedOverlayOrigin]="userMenuOrigin" 
                                          [cdkConnectedOverlayOpen]="userMenuOpenIndex === i" 
                                          [cdkConnectedOverlayHasBackdrop]="true" 
                                          [cdkConnectedOverlayBackdropClass]="'cdk-overlay-transparent-backdrop'" 
                                          (backdropClick)="onUserMenuClosed()" 
                                          (overlayOutsideClick)="onUserMenuClosed()" 
                                          [cdkConnectedOverlayPositions]="stepMenuOverlayPosition">
                                          <div class="dropdown-menu-panel" role="menu" aria-label="step actions" (keydown.escape)="onUserMenuClosed()" tabindex="0">
                                                <button type="button" class="dropdown-menu-item" (click)="addUserManager(user); onUserMenuClosed()"> üë®üèª‚Äçüíº Ch·ªânh s·ª≠a qu·∫£n l√Ω </button>     
                                                <button type="button" class="dropdown-menu-item" (click)="editUser(user); onUserMenuClosed()"> ‚öôÔ∏è S·ª≠a </button>                  
                                                <button type="button" class="dropdown-menu-item" (click)="onUserMenuClosed();" style="color: red;"> ‚õî X√≥a </button>   
                                          </div>
                                    </ng-template>
                              </div>
                        </td>
                  </tr>
            </tbody>
      </table>
</div>