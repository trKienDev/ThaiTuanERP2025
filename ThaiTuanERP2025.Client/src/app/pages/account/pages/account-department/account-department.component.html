<h2>Quản lý phòng ban</h2>

<div class="d-flex gap-20p">
      <div class="primary-card">
            <div class="card-header">
                  <div class="card-title">Thêm phòng ban</div>
            </div>
            <div class="card-body">
                  <form class="d-flex gap-10p" (ngSubmit)="addDepartment()" #departmentForm="ngForm">
                        <input class="w-25" type="text" name="code" [(ngModel)]="newDepartment.code" placeholder="Mã phòng ban" required/>
                        <input class="w-60" type="text" name="name" [(ngModel)]="newDepartment.name" placeholder="Tên phòng ban" required/>
                        <button class="w-15 button-62" type="submit" [disabled]="!departmentForm.valid">Thêm</button>
                  </form>
            </div>
      </div>

      <div class="primary-card">
            <div class="import-department-excel">
                  <div class="card-header">
                        Thêm phòng ban - Excel
                        <a href="/assets/templates/department-template.xlsx" download>
                              <i class="fa-solid fa-file-excel"></i>
                              Tải file Excel mẫu
                        </a>
                  </div>
                  <div class="card-body">
                        <input type="file" (change)="onFileSelected($event)" accept=".xlsx, .xls" />
                        <button (click)="uploadExcel()" [disabled]="importedDepartments.length === 0">
                              Import danh sách
                        </button>
                        <p *ngIf="importedDepartments.length">
                              Đã đọc được {{ importedDepartments.length }} phòng ban từ file Excel
                        </p>
                  </div>
            </div>
      </div>
</div>

<div *ngIf="successMessage" class="alert-success">
      {{ successMessage }}
</div>

<table class="table-departments">
      <thead>
            <tr>
                  <th>
                        <input #masterCheckbox type="checkbox" [checked]="isAllSelected()" (change)="toggleAll($event)" />
                  </th>
                  <th>Mã phòng ban</th>
                  <th>Tên phòng ban</th>
                  <th></th>
            </tr>
      </thead>
      <tbody>
            <tr *ngFor="let dept of departments">
                  <td>
                       <input type="checkbox" [(ngModel)]="dept.selected" (change)="updateMasterCheckboxState()" />
                  </td>
                  <td>{{ dept.code }}</td>
                  <td>{{ dept.name }}</td>
            </tr>
      </tbody>
</table>