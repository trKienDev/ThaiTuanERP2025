<div class="dialog">
      <div class="dialog-container">
            <div class="dialog-heading">
                  <div class="dialog-title">
                        <h1>Chi tiết thanh toán</h1>
                  </div>
                  <div class="dialog-close">
                        <button type="button" class="close-button" (click)="close()" aria-label="Đóng">
                              <span class="text material-icons-outlined">close</span>
                        </button>
                  </div>
            </div>
            <div class="dialog-body">
                        <ng-container *ngIf="loading()">Đang tải...</ng-container>
                        <ng-container *ngIf="err()">{{ err() }}</ng-container>
                  <div class="expense-payment-detail-container">
                        <div class="payment-heading display-flex gap-10px align-items-center">
                              <div class="payment-status">
                                    <span class="payment-status-badge" [ngClass]="(paymentDetail?.status | expensePaymentStatus).class">
                                          {{ (paymentDetail?.status | expensePaymentStatus).text }}
                                    </span>
                              </div>
                              <h3 class="payment-name">{{ paymentDetail?.name }}</h3>
                              <ng-container *ngIf="paymentDetail?.status === 6">
                                    <div class="payment-outgoing-btn margin-left-auto">
                                          <button type="button" class="button pintura-button" (click)="navigateToOutgoingPaymentRequest()">
                                                Ghi nhận khoản tiền ra
                                          </button>
                                    </div>
                              </ng-container>
                        </div>
                        <div class="payment-body margin-top-15px">
                              <div class="general-information-block primary-card">
                                    <div class="card-header">Thông tin chung</div>
                                    <div class="card-body general-grid">
                                          <div class="row">
                                                <label>ID</label>
                                                <div class="value mono">{{ paymentDetail?.subId }}</div>
                                          </div>
                                          <div class="row">
                                                <label>Tạo bởi</label>
                                                <div class="value flex">
                                                      <img class="avatar" [src]="paymentDetail?.createdByUser | avatarUrlPipe" alt="avatar">
                                                      <span>{{ paymentDetail?.createdByUser?.fullName }}</span>
                                                </div>
                                          </div>
                                          <div class="row">
                                                <label>Tạo lúc</label>
                                                <div class="value">{{ paymentDetail?.createdDate | date:'HH:mm dd/MM/yyyy' }}</div>
                                          </div>
                                          <div class="row">
                                                <label>Công ty trả cho</label>
                                                <div class="value ellipsis" [title]="paymentDetail?.supplier?.name">
                                                      {{ paymentDetail?.supplier?.name }}
                                                </div>
                                          </div>
                                          <div class="row">
                                                <label>Nội dung thanh toán</label>
                                                <div class="value ellipsis">
                                                      {{ paymentDetail?.description }}
                                                </div>
                                          </div>
                                          <div class="row">
                                                <label>Luồng duyệt</label>
                                                <div class="value">
                                                      <ul class="avatar-stack">
                                                            <li *ngFor="let u of (paymentDetail?.workflowInstanceDetail?.steps || []); let i = index; trackBy: trackByIndex">
                                                                  <img class="avatar" [src]="u?.approverCandidates?.[0] | avatarUrlPipe" alt="approver">
                                                            </li>
                                                            <li class="more" *ngIf="(paymentDetail?.workflowInstanceDetail?.steps?.length || 0) > 6">
                                                                  +{{ (paymentDetail?.workflowInstanceDetail?.steps?.length || 0) - 6 }}
                                                            </li>
                                                      </ul>
                                                </div>
                                          </div>
                                          <div class="row">
                                                <label>Người theo dõi</label>
                                                <div class="value">
                                                      <ul class="avatar-stack">
                                                            <li *ngFor="let f of (paymentDetail?.followers || []); trackBy: trackByIndex">
                                                                  <img class="avatar" [src]="f | avatarUrlPipe" alt="follower">
                                                            </li>
                                                      </ul>
                                                </div>
                                          </div>
                                    </div>
                              </div>
                              <div class="payment-amount-block primary-card margin-top-15px">
                                    <div class="card-body">
                                          <div class="total-amount-block">
                                                <div class="amount-infor-block">
                                                      <label class="amount-infor-label" for="total-amount">Số tiền thanh toán</label>
                                                      <span>{{ paymentDetail?.totalWithTax | number:'1.0-0' }} VNĐ</span>
                                                </div>
                                                <div class="amount-infor-block">
                                                      <label class="amount-infor-label" for="payment-date">Ngày thanh toán</label>
                                                      <span>{{ paymentDetail?.dueDate | date: 'dd/MM/yyyy' }}</span>
                                                </div>
                                                <div class="amount-infor-block">
                                                      <label class="amount-infor-label" for="payment-date">Số tiền đã tạo lệnh</label>
                                                      <span></span>
                                                </div>
                                          </div>
                                          <div class="amount-item-block">
                                                <div class="payment-item-table margin-top-20px">
                                                      <table class="table table-center-text">
                                                            <thead>
                                                                  <tr>
                                                                        <th style="width: 1%;">#</th>
                                                                        <th>Hạng mục</th>
                                                                        <th class="head-quanity" style="width: 7%;">Số lượng</th>
                                                                        <th>Đơn giá</th>
                                                                        <th>Thành tiền</th>
                                                                        <th class="head-tax" style="width: 6%;">Thuế</th>
                                                                        <th>Số tiền thuế</th>
                                                                        <th>Số tiền có thuế</th>
                                                                        <th class="head-extension">Ngân sách</th>
                                                                        <th class="head-invoice">Hóa đơn</th>
                                                                  </tr>
                                                            </thead>
                                                            <tbody>
                                                                  <tr *ngFor="let item of paymentDetail?.items; let i = index">
                                                                        <td>{{ i + 1 }}</td>
                                                                        <td class="item-name">{{ item.itemName }}</td>
                                                                        <td class="item-quanity">{{ item.quantity | number:'1.0-0' }}</td>
                                                                        <td class="item-unit-price">{{ item.unitPrice | number:'1.0-0' }} VNĐ</td>
                                                                        <td class="item-amount">{{ item.amount | number:'1.0-0' }} VNĐ</td>
                                                                        <td class="item-tax">{{ (item.taxRate * 100) | number:'1.0-0' }}%</td>
                                                                        <td class="item-tax-amount">{{ item.taxAmount | number:'1.0-0' }} VNĐ</td>
                                                                        <td class="item-total-with-tax">{{ item.totalWithTax | number:'1.0-0' }} VNĐ</td>
                                                                        <td class="item-budget-code">{{ item.budgetCode?.code}} - {{ item.budgetCode?.name }}</td>
                                                                        <td class="item-invoice">
                                                                              <button type="button" class="button" [ngClass]="item.invoice ? 'default-button' : 'cancel-button'">
                                                                                    {{ item.invoice ? 'Xem hóa đơn' : 'Không hóa đơn' }}
                                                                              </button>
                                                                        </td>
                                                                  </tr>
                                                            </tbody>
                                                            <tfoot *ngIf="paymentDetail?.items?.length">
                                                                  <tr class="total-row">
                                                                        <td colspan="4" class=""><strong>Tổng</strong></td>
                                                                        <td>{{ paymentDetail?.totalAmount | number:'1.0-0' }} VNĐ</td>
                                                                        <td></td>
                                                                        <td>{{ paymentDetail?.totalTax | number:'1.0-0' }} VNĐ</td>
                                                                        <td>{{ paymentDetail?.totalWithTax | number:'1.0-0' }} VNĐ</td>
                                                                        <td colspan="4"></td>
                                                                  </tr>
                                                            </tfoot>
                                                      </table>
                                                </div>
                                          </div>
                                    </div>
                              </div>
                        </div>
                  </div>
            </div>
      </div>
</div>