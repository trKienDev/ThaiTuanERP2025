<!-- Nút mở canvas -->
<button class="btn btn-primary" (click)="open()">Tạo luồng duyệt</button>

<!-- Canvas full-screen -->
<div class="canvas-overlay" *ngIf="isOpen()">
      <!-- Thanh tiêu đề -->
      <div class="header">
            <div class="title">Tạo luồng duyệt chi phí</div>
            <div class="tools">
                  <button class="icon-btn" title="thu nhỏ">-</button>
                  <span class="zoom">65%</span>
                  <button class="icon-btn" title="phóng to">+</button>
                  <button class="btn-save" (click)="openNameDialog()">Lưu luồng</button>
                  <button class="close-btn" (click)="close()" title="Đóng">x</button>
            </div>
      </div>

      <!-- Khu vực vẽ (grid nền dạng chấm) -->
      <div class="canvas">
            <!-- Hàng sơ đồ: Start -> (các bước) -->
            <div class="flow-row">
                  <!-- Shape 'Gửi xử lý' -->
                  <div class="start-node">Gửi xử lý</div>

                  <!-- Nút '+' để thêm bước duyệt đầu tiên hoặc thêm giữa các bước -->
                  <button class="add-connector" (click)="openStepDialog()" title="Thêm bước duyệt">+</button>

                  <!-- Các bước duyệt tạo ra sau khi bấm '+' -->
                  <ng-container *ngFor="let step of steps(); let i = index">
                        <div class="arrow"></div>
                        <div class="step-card">
                              <div class="step-title">{{ step.title }}</div>
                        </div>
                        <div class="step-sub">
                              {{ step.flowType === 'any' ? 'Chỉ cần chọn 1 người duyệt' : step.flowType === 'all' ? 'Tất cả duyệt' : 'Lần lượt' }}
                              <span *ngIf="step.slaHours">SLA {{ step.slaHours }} h</span>
                        </div>
                        <!-- Nút '+' ở sau mỗi bước -->
                        <button class="add-connector" (click)="openStepDialog()" title="Thêm bước duyệt">+</button>
                  </ng-container>
            </div>
      </div>

</div>


<h1 class="sr-only">Approval workflow Engine</h1>